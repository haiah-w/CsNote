# 为什么需要异步

同步方式，如果处于IO等待状态，则同步阻塞，处理其他任务就需要创建额外的线程，并且需要进行线程的上下文切换；

创建大量线程、线程上下文切换，都是额外开销，拉低资源的利用率；

异步方式能够更好的利用多核优势，增加CPU利用率，更有效利用系统资源；

# 异步的实现方式

1、回调函数：提交任务并注册回调函数，任务完毕触发回调；

2、生产-消费模型

# 异步线程使用场景

1、IO操作应当尽量使用异步，IO通常是web应用的性能瓶颈(数据库、外部服务)

2、业务中存在不相互依赖的任务，可以通过异步并发执行；

# CompletableFuture

CompletableFuture是一个JDK异步框架；

提供丰富的API，用于更优雅的提交、编排异步任务、获取任务结果、处理任务异常；

并且可以指定执行异步任务的**线程池**，不指定则默认使用ForkJoinPool

---

1、supplyAsync：开启一个异步任务；可以指定线程池；

2、thenCompose：连接两个异步任务；

3、thenCombine：合并两个异步任务；

4、thenApply：上一个异步任务的后置处理；

5、applyToEither：再开启一个异步任务，并获取最先完成的任务；

6、exceptionally：用来处理任意任务的异常；

7、join、get：用于阻塞获取任务的执行结果；

8、allOf：等待所有异步任务执行结束，并进行后置处理；

9、anyOf：多个异步任务，任意完成一个，则继续后置处理；

10、whenComplete：为异步任务注册回调，当任务结束，触发回调
